<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>File Handling</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>File Handling</h1><br/><p><span style="color:#e01b24;">#Check if file/folder exists:</span></p><p></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">Clear-</span>Host<br /><br /><span style="color:#ff9d00;font-weight:700">if</span> (<span style="color:#ff9d00;font-weight:700">Test-Path</span> D<span style="color:#ff9d00;font-weight:700">:\</span>PowershellApplications<span style="color:#ff9d00;font-weight:700">\</span>my_top_process.txt){<br /><span style="color:#ff9d00;font-weight:700">Write-Output</span> “File Exists”<br />}<br /><span style="color:#ff9d00;font-weight:700">else</span>{<br /><span style="color:#ff9d00;font-weight:700">Write-Output</span> “File Does Not Exist”<br />}</pre></div></p><p></p><p></p><p></p><p></p><p><span style="color:#e01b24;">TXT FILES:</span></p><p></p><p></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">Get-Content</span> <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\test.txt&quot;</span><br /><span style="color:#ff9d00;font-weight:700">Get-Content</span> <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\test.txt&quot;</span> <span style="color:#ff9d00;font-weight:700">-</span>Tail <span style="color:#333333;font-weight:400">10</span><br />(<span style="color:#ff9d00;font-weight:700">Get-Content</span> <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\test.txt&quot;</span>)[<span style="color:#333333;font-weight:400">4</span>]<br /><br /><span style="color:#0088ff;font-weight:400">$file_out</span> <span style="color:#ff9d00;font-weight:700">=</span> (<span style="color:#ff9d00;font-weight:700">Get-Content</span> <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\test.txt&quot;</span>)[<span style="color:#333333;font-weight:400">4</span>..<span style="color:#333333;font-weight:400">6</span>]<br /><span style="color:#ff9d00;font-weight:700">Write-Output</span> <span style="color:#3ad900;font-weight:400">&quot;File content is $file_out&quot;</span><br /><br /><span style="color:#ff9d00;font-weight:700">Get-Content</span> <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\test.txt&quot;</span> | <span style="color:#ff9d00;font-weight:700">where</span> {<span style="color:#0088ff;font-weight:400">$_</span> <span style="color:#ff9d00;font-weight:700">-like</span> <span style="color:#3ad900;font-weight:400">&quot;*frame*&quot;</span>}<br /><br /><br /><span style="color:#0088ff;font-weight:400">#Select String in a file(grep):</span><br /><br /><span style="color:#0088ff;font-weight:400">$file_out</span> <span style="color:#ff9d00;font-weight:700">=</span> (<span style="color:#ff9d00;font-weight:700">Get-Content</span> <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\test.txt&quot;</span>)<br /><span style="color:#0088ff;font-weight:400">$file_out</span> | <span style="color:#ff9d00;font-weight:700">Select-String</span> <span style="color:#ff9d00;font-weight:700">-</span>Pattern <span style="color:#3ad900;font-weight:400">&quot;frame&quot;</span><br /><br /><br /><span style="color:#ff9d00;font-weight:700">Select-String</span> <span style="color:#ff9d00;font-weight:700">-</span>Path <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\*.txt&quot;</span> <span style="color:#ff9d00;font-weight:700">-</span>Pattern <span style="color:#3ad900;font-weight:400">&quot;frame&quot;</span><br /><br /><br /><span style="color:#0088ff;font-weight:400">#Şöyle güzel bişeyler:</span><br /><br /><span style="color:#0088ff;font-weight:400">$file_name</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\test.txt&quot;</span><br /><span style="color:#ff9d00;font-weight:700">try</span>{<br />	<span style="color:#ff9d00;font-weight:700">if</span>(<span style="color:#ff9d00;font-weight:700">Test-Path</span> <span style="color:#0088ff;font-weight:400">$file_name</span>){<br />		<span style="color:#ff9d00;font-weight:700">Write-Output</span> <span style="color:#3ad900;font-weight:400">&quot;File Exists&quot;</span><br />		<span style="color:#0088ff;font-weight:400">$last_10_lines</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">Get-Content</span> <span style="color:#ff9d00;font-weight:700">-</span>Path <span style="color:#0088ff;font-weight:400">$file_name</span> <span style="color:#ff9d00;font-weight:700">-</span>Tail <span style="color:#333333;font-weight:400">10</span> <span style="color:#333333;font-weight:400">-ErrorAction</span> stop <span style="color:#333333;font-weight:400">-ErrorVariable</span> <span style="color:#3ad900;font-weight:400">&quot;err&quot;</span><br />		<span style="color:#ff9d00;font-weight:700">Write-Output</span> <span style="color:#3ad900;font-weight:400">&quot;Last 10 lines: &quot;</span><br />		<span style="color:#ff9d00;font-weight:700">Write-Output</span> <span style="color:#0088ff;font-weight:400">$last_10_lines</span><br />	}<br />	<span style="color:#ff9d00;font-weight:700">else</span>{<br />		<span style="color:#ff9d00;font-weight:700">Write-Output</span> <span style="color:#3ad900;font-weight:400">&quot;File does not exists!&quot;</span><br />	}<br />}<br /><span style="color:#ff9d00;font-weight:700">catch</span>{<br />	<span style="color:#ff9d00;font-weight:700">Write-Output</span> <span style="color:#3ad900;font-weight:400">&quot;Something Went Wrong = $err&quot;</span><br />}<br /><br /><br /><br /></pre></div></p><p></p><p></p><p><span style="color:#e01b24;">WRITING INTO TXT:</span></p><p></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">Write-Output</span> <span style="color:#3ad900;font-weight:400">&quot;$(Get-Date): This is a text&quot;</span> | <span style="color:#ff9d00;font-weight:700">Out-File</span> <span style="color:#ff9d00;font-weight:700">-</span>FilePath D<span style="color:#ff9d00;font-weight:700">:\</span>PowerShellApplications<span style="color:#ff9d00;font-weight:700">\</span>wtxt_test.txt<br /><span style="color:#ff9d00;font-weight:700">Write-Output</span> <span style="color:#3ad900;font-weight:400">&quot;$(Get-Process): List of process&quot;</span> |<span style="color:#ff9d00;font-weight:700">Out-File</span> <span style="color:#ff9d00;font-weight:700">-</span>FilePath D<span style="color:#ff9d00;font-weight:700">:\</span>PowerShellApplications<span style="color:#ff9d00;font-weight:700">\</span>wtxt_test.txt <span style="color:#ff9d00;font-weight:700">-</span>Append</pre></div></p><p>-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</p><p></p><p></p><p><span style="color:#e01b24;">CSV FILES:</span></p><p></p><p><table style="display:inline-table"><tr><td><a href="EmbeddedFiles/65-csvtest.csv">Linked file: csvtest.csv </a></td></tr></table></p><p></p><p></p><p><div class="codebox"><pre><span style="color:#0088ff;font-weight:400">#Get-Content CMD ile her türlü dosya okunabilir. Ancak bu durumda csv. uzantısı için olan özellikler kullanılamaz.</span><br /><br /><span style="color:#0088ff;font-weight:400">$get_csv</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">Get-Content</span> <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\File Handling\csvtest.csv&quot;</span><br /><span style="color:#0088ff;font-weight:400">$get_csv</span><br /><br /><br /><span style="color:#0088ff;font-weight:400">#IMPORT CSV:</span><br /><span style="color:#0088ff;font-weight:400">$get_csv_properly</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">Import-Csv</span> <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\File Handling\csvtest.csv&quot;</span><br /><span style="color:#0088ff;font-weight:400">$get_csv_properly</span></pre></div></p><p></p><p><img src="images/65-1.png" alt="images/65-1.png" /></p><p></p><p></p><p></p><p><div class="codebox"><pre><span style="color:#0088ff;font-weight:400">#Azcık eğlenelim:</span><br /><br /><span style="color:#0088ff;font-weight:400">$get_csv</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">Import-Csv</span> <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\File Handling\csvtest.csv&quot;</span><br /><span style="color:#0088ff;font-weight:400">$get_csv</span> | <span style="color:#ff9d00;font-weight:700">Sort-Object</span> Student <span style="color:#0088ff;font-weight:400">#Student&#39;a göre sırala.</span><br /><span style="color:#0088ff;font-weight:400">$get_csv</span> | <span style="color:#ff9d00;font-weight:700">Select-Object</span> <span style="color:#ff9d00;font-weight:700">-</span>First <span style="color:#333333;font-weight:400">2</span><br /> </pre></div></p><p></p><p></p><p></p><p></p><p></p><p><div class="codebox"><pre><span style="color:#0088ff;font-weight:400">#Add content:</span><br /><span style="color:#ff9d00;font-weight:700">Add-Content</span> <span style="color:#ff9d00;font-weight:700">-</span>Path <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\File Handling\create_csv.csv&quot;</span> <span style="color:#333333;font-weight:400">-Value</span> <span style="color:#333333;font-weight:400">&#39;&quot;Student&quot;,&quot;Number&quot;,&quot;Grade&quot;&#39;</span> <br /><br /><br /><span style="color:#0088ff;font-weight:400">#ARRAY:</span><br /><span style="color:#0088ff;font-weight:400">$student_data</span> <span style="color:#ff9d00;font-weight:700">=</span> @(<br />    <span style="color:#333333;font-weight:400">&#39;&quot;Burc&quot;,&quot;23&quot;,&quot;98&quot;&#39;</span><br />    <span style="color:#333333;font-weight:400">&#39;&quot;Gulden&quot;,&quot;67&quot;,&quot;67&quot;&#39;</span>    <br />    <span style="color:#333333;font-weight:400">&#39;&quot;Atıf&quot;,&quot;56&quot;,&quot;78&quot;&#39;</span><br />)<br /><br /><span style="color:#0088ff;font-weight:400">$student_data</span> | <span style="color:#ff9d00;font-weight:700">foreach</span> {<span style="color:#ff9d00;font-weight:700">Add-Content</span> <span style="color:#ff9d00;font-weight:700">-</span>Path <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\File Handling\create_csv.csv&quot;</span> <span style="color:#333333;font-weight:400">-Value</span> <span style="color:#0088ff;font-weight:400">$_</span>}<br /><span style="color:#0088ff;font-weight:400">$student_data</span><br /></pre></div></p><p></p><p></p><p><span style="color:#e01b24;">EXPORT:</span></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">Import-Csv</span> <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\File Handling\csvtest.csv&quot;</span> | <br /><span style="color:#ff9d00;font-weight:700">Sort-Object</span> Student | <br /><span style="color:#ff9d00;font-weight:700">Export-Csv</span> <span style="color:#3ad900;font-weight:400">&quot;D:\PowerShellApplications\File Handling\create_csv2.csv&quot;</span> <span style="color:#ff9d00;font-weight:700">-</span>NoTypeInformation</pre></div></p><p></p><p></p><p></p><p></p><p><span style="color:#e01b24;">XML &amp; JSON:</span></p><p></p><p></p></div>
</body>
</html>
